<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Network.WebSockets.STM</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Network-WebSockets-STM.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">aesd-records-0.4.4.4: AESD Records</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(c) 2018 Alliance for Sustainable Energy LLC</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>Brian W Bush &lt;brian.bush@nrel.gov&gt;</td></tr><tr><th>Stability</th><td>Stable</td></tr><tr><th>Portability</th><td>Portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Network.WebSockets.STM</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Control</a></li><li><a href="#g:3">Communication</a></li><li><a href="#g:4">Computation</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>WebSockets with STM queues for sending and receiving messages.  There is one thread for sending messages, another thread for receiveing them, and separate threads to process the messages received from each request.  Each worker can also have its own thread.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Communicator">Communicator</a> s r k</li><li class="src short"><a href="#v:start">start</a> :: (<a href="http://hackage.haskell.org/packages/archive/websockets/0.10.0.0/doc/html/Network-WebSockets.html#t:WebSocketsData">WebSocketsData</a> s, <a href="http://hackage.haskell.org/packages/archive/websockets/0.10.0.0/doc/html/Network-WebSockets.html#t:WebSocketsData">WebSocketsData</a> r, <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Ord.html#t:Ord">Ord</a> k) =&gt; <a href="http://hackage.haskell.org/packages/archive/websockets/0.10.0.0/doc/html/Network-WebSockets-Connection.html#t:Connection">Connection</a> -&gt; (k -&gt; s -&gt; s) -&gt; (r -&gt; k) -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> (<a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k)</li><li class="src short"><a href="#v:stop">stop</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:waitToStop">waitToStop</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:complete">complete</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Ord.html#t:Ord">Ord</a> k =&gt; <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:send">send</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; k -&gt; s -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:launch">launch</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Ord.html#t:Ord">Ord</a> k =&gt; <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; k -&gt; (r -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:forkWork">forkWork</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> () -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</li></ul></div><div id="interface"><h1 id="g:1">Types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Communicator" class="def">Communicator</a> s r k</p><div class="doc"><p>The state of communication via WebSockets.</p></div></div><h1 id="g:2">Control</h1><div class="top"><p class="src"><a name="v:start" class="def">start</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="http://hackage.haskell.org/packages/archive/websockets/0.10.0.0/doc/html/Network-WebSockets.html#t:WebSocketsData">WebSocketsData</a> s, <a href="http://hackage.haskell.org/packages/archive/websockets/0.10.0.0/doc/html/Network-WebSockets.html#t:WebSocketsData">WebSocketsData</a> r, <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Ord.html#t:Ord">Ord</a> k)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="http://hackage.haskell.org/packages/archive/websockets/0.10.0.0/doc/html/Network-WebSockets-Connection.html#t:Connection">Connection</a></td><td class="doc"><p>The WebSockets connection.</p></td></tr><tr><td class="src">-&gt; (k -&gt; s -&gt; s)</td><td class="doc"><p>Function for adding the key to a message.</p></td></tr><tr><td class="src">-&gt; (r -&gt; k)</td><td class="doc"><p>Function for getting the key of a message.</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> (<a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k)</td><td class="doc"><p>Action to create the threads and start communication.</p></td></tr></table></div><div class="doc"><p>Fork the threads needed for communication.</p></div></div><div class="top"><p class="src"><a name="v:stop" class="def">stop</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Kill the communication threads.</p></div></div><div class="top"><p class="src"><a name="v:waitToStop" class="def">waitToStop</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Wait for the WebSockets connection to be closed.</p></div></div><div class="top"><p class="src"><a name="v:complete" class="def">complete</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Ord.html#t:Ord">Ord</a> k</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k</td><td class="doc"><p>The state of communication.</p></td></tr><tr><td class="src">-&gt; k</td><td class="doc"><p>The message key.</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</td><td class="doc"><p>Action for stopping the processing of messages with the key.</p></td></tr></table></div><div class="doc"><p>Stop processing messages with a particular key.</p></div></div><h1 id="g:3">Communication</h1><div class="top"><p class="src"><a name="v:send" class="def">send</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k</td><td class="doc"><p>The state of communication.</p></td></tr><tr><td class="src">-&gt; k</td><td class="doc"><p>The message key.</p></td></tr><tr><td class="src">-&gt; s</td><td class="doc"><p>The message to be sent.</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</td><td class="doc"><p>Action for enqueuing the message for sending.</p></td></tr></table></div><div class="doc"><p>Send a message.</p></div></div><div class="top"><p class="src"><a name="v:launch" class="def">launch</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Ord.html#t:Ord">Ord</a> k</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k</td><td class="doc"><p>The state of communication.</p></td></tr><tr><td class="src">-&gt; k</td><td class="doc"><p>The message key.</p></td></tr><tr><td class="src">-&gt; (r -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/Data-Bool.html#t:Bool">Bool</a>)</td><td class="doc"><p>Handler for messages, which returns whether the handling of this message key is complete.</p></td></tr><tr><td class="src">-&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</td><td class="doc"><p>Action for processing incoming messages.</p></td></tr></table></div><div class="doc"><p>Process messages for a given key.</p></div></div><h1 id="g:4">Computation</h1><div class="top"><p class="src"><a name="v:forkWork" class="def">forkWork</a> :: <a href="Network-WebSockets-STM.html#t:Communicator">Communicator</a> s r k -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> () -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.8.2.0/doc/html/System-IO.html#t:IO">IO</a> ()</p><div class="doc"><p>Fork a worker thread.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>